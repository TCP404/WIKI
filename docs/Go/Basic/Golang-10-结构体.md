# 10-ç»“æ„ä½“

Goè¯­è¨€ä¸­æ²¡æœ‰â€œç±»â€çš„æ¦‚å¿µï¼Œä¹Ÿä¸æ”¯æŒâ€œç±»â€çš„ç»§æ‰¿ç­‰é¢å‘å¯¹è±¡çš„æ¦‚å¿µã€‚Goè¯­è¨€ä¸­é€šè¿‡ç»“æ„ä½“çš„å†…åµŒå†é…åˆæ¥å£æ¯”é¢å‘å¯¹è±¡å…·æœ‰æ›´é«˜çš„æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚

å½“æˆ‘ä»¬æƒ³è¡¨ç¤ºä¸€äº›äº‹ç‰©æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸºæœ¬æ•°æ®ç±»å‹è¡¨ç¤ºå…¶å„é¡¹åŸºæœ¬å±æ€§ï¼Œé€šè¿‡ç»“æ„ä½“å°†å…¶ç»„åˆèµ·æ¥ã€‚åœ¨ Go ä¸­å¯ä»¥é€šè¿‡ `struct` å®ç°é¢å‘å¯¹è±¡ã€‚


!!!warning
    **ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼ï¼ï¼**

## å®šä¹‰
ä½¿ç”¨ `type` å’Œ `struct` æ¥å®šä¹‰ç»“æ„ä½“ã€‚

åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š
```go
type structT struct {
    field1 T
    field2 T
    ...
}
```
`structT`ï¼šæ ‡è¯†åªå®šä¹‰ç»“æ„ä½“åç§°ï¼ŒåŒä¸€åŒ…å†…ä¸èƒ½é‡å¤ã€‚

`field`ï¼šç»“æ„çš„åŸºæœ¬å±æ€§çš„åå­—ï¼Œç»“æ„ä½“ä¸­çš„å­—æ®µåä¸èƒ½é‡å¤

`T`ï¼šå­—æ®µçš„å…·ä½“ç±»å‹

!!! example
    ```go
    type person struct {
        name string
        age int8
        city string
    }
    ```
    åŒç±»å‹å­—æ®µå¯ä»¥å†™åœ¨ä¸€è¡Œ
    ```go
    type person struct {
        name, city string
        age int8
    }
    ```

é€šè¿‡ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª `person` çš„è‡ªå®šä¹‰ç±»å‹ï¼Œå®ƒæœ‰ `name`ã€`age`ã€`city` ä¸‰ä¸ªå­—æ®µï¼Œè¡¨ç¤ºäººçš„å§“åã€å¹´é¾„ã€åŸå¸‚ä¸‰ä¸ªå±æ€§ã€‚
è¿™æ ·å°±å¯ä»¥é€šè¿‡ `person` è¿™ä¸ªç»“æ„ä½“å¾ˆæ–¹ä¾¿çš„åœ¨ç¨‹åºä¸­è¡¨ç¤ºå’Œå­˜å‚¨äººçš„ä¿¡æ¯äº†ã€‚

!!! tip
    åœ¨å®šä¹‰ç»“æ„ä½“æ—¶ï¼Œå»ºè®®å„ä¸ªå­—æ®µæŒ‰å­—æ®µç±»å‹ä»å°åˆ°å¤§æ’åºï¼Œæœ‰åŠ©äº[å†…å­˜å¯¹é½](https://segmentfault.com/a/1190000017527311)ã€‚
    ç±»å‹å¤§å°å‚è€ƒ[ã€Šæ•°æ®ç±»å‹ã€‹ä¸€ç« ](https://blog.csdn.net/mr_pro/article/details/113820586)

Go å†…ç½®çš„åŸºæœ¬æ•°æ®ç±»å‹ç”¨æ¥æè¿°ä¸€ä¸ªå€¼ï¼Œè€Œç»“æ„ä½“ç”¨æ¥æè¿°ä¸€ç»„å€¼ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§èšåˆå‹æ•°æ®ç±»å‹ã€‚
ä¸€ä¸ªç»“æ„ä½“å°±åƒ Java ä¸­çš„ä¸€ä¸ªç±»ï¼Œä¸è¿‡ Java ä¸­çš„ç±»è¿˜æœ‰æ„é€ å‡½æ•°ã€æ–¹æ³•ç­‰ï¼Œè¿™äº› Go çš„ç»“æ„ä½“ä¸€æ ·å¯ä»¥å®ç°ï¼Œæ–¹å¼æœ‰äº›ä¸åŒ

## å®ä¾‹åŒ–
åªæœ‰å½“ç»“æ„ä½“å®ä¾‹åŒ–æ—¶ï¼Œæ‰ä¼šçœŸæ­£åœ°åˆ†é…å†…å­˜ã€‚å³å¿…é¡»å®ä¾‹åŒ–åæ‰èƒ½ä½¿ç”¨ç»“æ„ä½“çš„å­—æ®µã€‚
ç»“æ„ä½“æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åƒå£°æ˜åŸºæœ¬æ•°æ®ç±»å‹ä¸€æ ·å£°æ˜ç»“æ„ä½“

```go
// æ–¹å¼1
var idn structT
idn.field1 = value1
idn.field2 = value2
...
```

`idn`ï¼šç»“æ„ä½“å®ä¾‹åç§°

`structT`ï¼šç»“æ„ä½“ç±»å‹

`field`ï¼šç»“æ„ä½“å­—æ®µ

### æ–¹å¼1ï¼šåŸºæœ¬å®ä¾‹åŒ–
```go
type person struct {
    name string
    city string
    age int8
}

func main() {
    // æ–¹å¼1
    var p1 person
    p1.city = "SWA"
    p1.name = "Boii"

    fmt.Printf("p1 = %v \n", p1)	// p1 = {Boii 0 SWA}
    fmt.Printf("p1 = %#v \n", p1)	// p1 = main.person{name:"Boii", age:0, city:"SWA"}
}
```
ä»”ç»†è§‚å¯Ÿï¼š

- æ–¹å¼1å£°æ˜ä»¥åé€ä¸€ç»™æ¯ä¸ªå­—æ®µèµ‹å€¼ï¼Œå¯ä»¥ç»“æ„ä½“ä¸­å®šä¹‰å­—æ®µæ—¶çš„é¡ºåºï¼Œæ²¡æœ‰èµ‹å€¼çš„å­—æ®µé»˜è®¤ä¸ºé›¶å€¼
- æ–¹å¼2 å’Œ æ–¹å¼3åœ¨èµ‹å€¼çš„æ—¶å€™éœ€è¦æ‰€æœ‰å­—æ®µéƒ½èµ‹å€¼ï¼Œä¸”éœ€è¦æŒ‰é¡ºåºã€‚
- é€šè¿‡`.`å¯ä»¥è®¿é—®ç»“æ„ä½“ä¸­çš„å­—æ®µï¼Œä¾‹å¦‚`p1.city`.

### æ–¹å¼2ï¼šnew(T) ç»“æ„ä½“æŒ‡é’ˆ
é€šè¿‡ `new()` å¯ä»¥å¯¹ç»“æ„ä½“å®ä¾‹åŒ–ï¼Œå¾—åˆ°çš„æ˜¯ç»“æ„ä½“æŒ‡é’ˆï¼Œå…¶å„ä¸ªå­—æ®µéƒ½ä¸ºé›¶å€¼ã€‚

```go
type person struct {
    name string
    city string
    age  int8
}
func main() {

    var p1 = new(person)
    fmt.Printf("%T \n", p1)      // *main.person
    fmt.Printf("p1 = %#v \n", p1) // p1 = &main.person{name:"", age:0, city:""}
    
    p1.name = "Boii"
    fmt.Printf("p1 = %#v \n", p1) // p1 = &main.person{name:"Boii", age:0, city:""}
}
```

**æ³¨æ„**ï¼šGo ä¸­çš„ç»“æ„ä½“æŒ‡é’ˆå¯ä»¥ç›´æ¥ä½¿ç”¨`.`æ¥è®¿é—®ç»“æ„ä½“æˆå‘˜ã€‚

`p1.name = "Boii"` ç›¸å½“äº `(*p1).name = "Boii"`ï¼Œè¿™æ˜¯ Go çš„è¯­æ³•ç³–ã€‚

### æ–¹å¼3ï¼š&T{} å–ç»“æ„ä½“åœ°å€
ä½¿ç”¨ `&` å¯¹ç»“æ„ä½“å–åœ°å€æ“ä½œç›¸å½“äºå¯¹è¯¥ç»“æ„ä½“ç±»å‹è¿›è¡Œäº†ä¸€æ¬¡ `new`å®ä¾‹åŒ–æ“ä½œã€‚
```go
type person struct {
    name string
    city string
    age  int8
}
func main() {
    var p2 = &person{"Boii", 10, "SWA"}
    fmt.Printf("%T \n", p2)       // *main.person
    fmt.Printf("p2 = %#v \n", p2) // p = &main.person{name:"Boii", age:10, city:"SWA"}

    p3 := &person{}
    p3.name = "Candy"
    p3.age = 10
    p3.city = "SWA"
    fmt.Printf("%T \n", p3)       // *main.person
    fmt.Printf("p3 = %#v \n", p3) // p = &main.person{name:"Candy", age:10, city:"SWA"}

}
```

æ‰€ä»¥ï¼š`new(Type)` å’Œ `&Type{}` æ˜¯ç­‰ä»·çš„ã€‚

![](https://blogpicure.oss-cn-shenzhen.aliyuncs.com/blog/illustration-pic/Go/IMG/20201122164056342_11482.png)

![](https://blogpicure.oss-cn-shenzhen.aliyuncs.com/blog/illustration-pic/Go/IMG/20201122164122020_21432.png)

### åŒ¿åç»“æ„ä½“

åœ¨å®šä¹‰ä¸€äº›ä¸´æ—¶æ•°æ®ç»“æ„ç­‰åœºæ™¯ä¸‹è¿˜å¯ä»¥ä½¿ç”¨åŒ¿åç»“æ„ä½“ã€‚
```go
func main() {
    var user struct{name string; age int8}  // (1)
    
    // é€šè¿‡ç»“æ„ä½“å®ä¾‹ä½¿ç”¨åŒ¿åç»“æ„ä½“
    user.name = "Boii"
    user.age = 18

    fmt.Printf("%v \n", user)  // {Boii 18}
    fmt.Printf("%#v \n", user) // struct { name string; age int8 }{name:"Boii", age:18}

    // ç›¸åŒç±»å‹å¯ä»¥ç®€å†™
    var stu struct{name string; ID, age int}

    // è§„èŒƒå†™æ³•
    var stud struct {
        name    string
        ID, age int
    }
}
```

1. å®šä¹‰åŒ¿åç»“æ„ä½“ï¼Œå­—æ®µä¹‹é—´ç”¨ åˆ†å· éš”å¼€

## åˆå§‹åŒ–
ç»“æ„ä½“æ²¡æœ‰åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆå‘˜å˜é‡éƒ½æ˜¯å¯¹åº”ç±»å‹çš„é›¶å€¼ï¼Œè¿™ç‚¹åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å·²ç»æœ‰æ‰€ä½“ç°ã€‚
```go
type stu struct {
    name string
    age  int8
    ID   int8
}

func main() {
    var s1 stu
    fmt.Printf("s1 = %#v \n", s1) // s1 = main.stu{name:"", age:0, ID:0}
}
```

### ä½¿ç”¨é”®å€¼å¯¹çš„æ–¹å¼åˆå§‹åŒ–
```go
idn := structT{
    field1: value1,
    field2: value2,
    ...
}


var idn = structT{
    field1: value1,
    field2: value2,
    ...
}
```

!!! example
    ```go
    s2 := stu{
        name: "Boii",
        age:  18,
    }
    fmt.Printf("s2 = %#v \n", s2) // s2 = main.stu{name:"Boii", age:18, ID:0}

    var s3 = stu{
        name: "Eva",
        age:  18,
    }
    fmt.Printf("s3 = %#v \n", s3) // s3 = main.stu{name:"Eva", age:18, ID:0}
    ```
ä½¿ç”¨é”®å€¼å¯¹çš„æ–¹å¼å¯ä»¥ä¸æŒ‰ç»“æ„ä½“å®šä¹‰æ—¶å­—æ®µçš„é¡ºåºï¼Œå¯ä»¥ä¸åˆå§‹åŒ–æ¯ä¸€ä¸ªå­—æ®µï¼Œæ²¡è¢«åˆå§‹åŒ–çš„å­—æ®µå°±é»˜è®¤ä¸ºé›¶å€¼ã€‚
æ³¨æ„æœ€åä¸€ä¸ªå­—æ®µä¹Ÿè¦åŠ ä¸Šé€—å·`,`ã€‚

```go
s3 := &stu{
    age: 18,
    ID:  101,
}
fmt.Printf("s3 = %#v \n", s3) // s3 = &main.stu{name:"", age:18, ID:101}
```
ä¹Ÿå¯ä»¥å¯¹ç»“æ„ä½“æŒ‡é’ˆè¿›è¡Œé”®å€¼å¯¹åˆå§‹åŒ–

### ä½¿ç”¨å€¼åˆ—è¡¨çš„æ–¹å¼åˆå§‹åŒ–
åˆå§‹åŒ–ç»“æ„ä½“çš„æ—¶å€™å¯ä»¥ç®€å†™ï¼Œä¸å†™é”®ï¼Œåªå†™å€¼ã€‚
```go
idn := structT{
    value1,
    value2,
    ...
}

var idn = structT{
    value1,
    value2,
    ...
}
```

!!! example
    ```go
    s4 := stu{
        "Boii",
        18,
        102,
    }
    fmt.Printf("s4 = %#v \n", s4) // s4 = main.stu{name:"Boii", age:18, ID:102}
    ```

ä½¿ç”¨è¿™ç§è¦æ³¨æ„ï¼š

1. å¿…é¡»åˆå§‹åŒ–ç»“æ„ä½“é‡Œæ‰€æœ‰å­—æ®µ
2. åˆå§‹å€¼å¡«å……é¡ºåºå¿…é¡»å’Œå­—æ®µåœ¨ç»“æ„ä½“ä¸­å£°æ˜çš„é¡ºåºä¸€è‡´
3. ä¸èƒ½å’Œé”®å€¼å¯¹çš„åˆå§‹åŒ–æ–¹å¼æ··ç”¨

### ä¸€ç‚¹ç»†èŠ‚

åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœå€¼å†™æˆå¤šè¡Œï¼Œåˆ™æœ€åä¸€ä¸ªä¹Ÿè¦å¸¦ä¸Šé€—å· `,` ;

å¦‚æœå†™æˆä¸€è¡Œï¼Œåˆ™æœ€åä¸€ä¸ªå¯ä»¥ä¸å¸¦é€—å· `,` ; ä¹Ÿå¯ä»¥å¸¦ä¸Šé€—å·ã€‚



```go
type Person struct {
    name string
    age  int
    sex  string
}

func main() {
    p1 := Person{
        "Boii",
        18,
        "male",
    }

    p2 := Person{
        name: "Boii",
        sex:  "male",
        age:  18,
    }

    p3 := Person{ "Boii", 18, "male" }

    p4 := Person{ name: "Boii", sex: "male", age: 18, }
}
```

## æ–¹æ³•å’Œæ¥æ”¶è€…

ä¾‹å¦‚ä¸‹é¢çš„é€šå¼ï¼Œæ–¹æ³•åå‰é¢çš„**æ¥æ”¶è€…å˜é‡å’Œæ¥æ”¶è€…ç±»å‹**ï¼Œå°±æ˜¯ä¸€ç§é™å®šã€‚
```go
// æ–¹æ³•
func (æ¥æ”¶è€…å˜é‡ æ¥æ”¶è€…ç±»å‹) æ–¹æ³•å(å‚æ•°åˆ—è¡¨) (è¿”å›å‚æ•°) {
    æ–¹æ³•ä½“
}

// å¯¹æ¯”ï¼šå‡½æ•°
func å‡½æ•°å(å‚æ•°åˆ—è¡¨) (è¿”å›å‚æ•°) {
    å‡½æ•°ä½“
}
```
**æ¥æ”¶è€…æŒ‡çš„å°±æ˜¯è¢«å…è®¸è°ƒç”¨çš„è°ƒç”¨è€…**ã€‚æ³¨æ„ç†è§£ï¼šä¸‹é¢å°†ä»¥æ¥æ”¶è€…ä»£æ›¿è°ƒç”¨è€…çš„è¯´æ³•ã€‚

- **æ¥æ”¶è€…å˜é‡**ï¼šå‘½åæ—¶ï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨æ¥æ”¶è€…ç±»å‹é¦–ä¸ªå­—æ¯å°å†™ã€‚egï¼š`p Person`ã€`c Connector`
- **æ¥æ”¶è€…ç±»å‹**ï¼šæ¥æ”¶è€…ç±»å‹å’Œå‚æ•°ç›¸ä¼¼ï¼Œå¯ä»¥æ˜¯æŒ‡é’ˆç±»å‹æˆ–éæŒ‡é’ˆç±»å‹
- **æ–¹æ³•åã€å‚æ•°åˆ—è¡¨ã€è¿”å›å‚æ•°**ï¼šå…·ä½“æ ¼å¼ä¸å‡½æ•°å®šä¹‰ç›¸åŒ

```go
// Dog ç»“æ„ä½“
type Dog struct {
    name string
    age  int8
}

// NewDog æ„é€ å‡½æ•°
func NewDog(name string, age int8) *Dog {
    return &Dog{name, age}
}

// Run Dogå¥”è·‘çš„æ–¹æ³•
// é™å®šäº† Dog ç»“æ„ä½“ç±»å‹æ‰å¯ä»¥è°ƒç”¨æ­¤æ–¹æ³•
func (d Dog) Run(distance int) {
    fmt.Printf("%d å²çš„ç‹—ç‹— %s è·‘äº† %d ç±³\n", d.age, d.name, distance)
}

func main() {
    boby := NewDog("Boby", 2)
    boby.Run(100)
    doge := Dog{"Doge", 3}
    doge.Run(12)
}

// -------------------------------------------------
// Output:
2 å²çš„ç‹—ç‹— Boby è·‘äº† 100 ç±³
3 å²çš„ç‹—ç‹— Doge è·‘äº† 12 ç±³
```

### ğŸ¥·æŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…

!!! note
    å¦‚æœæŒ‡å®šæŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…ï¼Œåœ¨æ–¹æ³•å†…ä¿®æ”¹æ¥æ”¶è€…çš„æˆå‘˜å˜é‡ï¼Œåˆ™ **ç»“æŸæ–¹æ³•åä¿®æ”¹ä¾ç„¶æœ‰æ•ˆ**ã€‚

ä¾‹å¦‚æˆ‘ä»¬ä¸º `Dog` æ·»åŠ ä¸€ä¸ª `setAge` æ–¹æ³•ï¼š
```go
func (d *Dog) SetAge(newAge int8) {
    d.age = newAge
}

func main() {
	boby := NewDog("Boby", 2)
	fmt.Println(boby.age) // 2
	boby.SetAge(10)
	fmt.Println(boby.age) // 10
}
```

### ğŸ‘¨â€ğŸ’»å€¼ç±»å‹çš„æ¥æ”¶è€…

!!! note
    å½“æ–¹æ³•ä½œç”¨äºå€¼ç±»å‹æ¥æ”¶è€…æ—¶ï¼ŒGo ä¼šåœ¨è¿è¡Œæ—¶å°†æ¥æ”¶è€…çš„å€¼å¤åˆ¶ä¸€ä»½ã€‚ä¸è¿‡ **åœ¨æ–¹æ³•å†…å¯¹æ¥æ”¶è€…çš„ä¿®æ”¹åªæ˜¯å¯¹å‰¯æœ¬çš„ä¿®æ”¹**ï¼Œä¸ä¼šå½±å“æ¥æ”¶è€…ã€‚

    ä½†æ˜¯åœ¨ç¼–è¯‘å™¨ä¸­ï¼Œä¸€ä¸ªç»“æ„ä½“â€œå€¼å®ç°â€äº†ä¸€ä¸ªæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¸®ä½ å¤šæ¥ä¸€æ¬¡â€œæŒ‡é’ˆå®ç°â€ã€‚

    å³ï¼š
    
    - å€¼å®ç° = å€¼å®ç° + æŒ‡é’ˆå®ç°ï¼›
    - æŒ‡é’ˆå®ç° = æŒ‡é’ˆå®ç°ã€‚

    è¿™ä¸€ç‚¹åœ¨æ¥å£ä¸­æœ‰åŒºåˆ«ã€‚

```go
func (d Dog) SetAge(newAge int8) {
    d.age = newAge
}

func main() {
	boby := NewDog("Boby", 2)
	fmt.Println(boby.age) // 2
	boby.SetAge(10)
	fmt.Println(boby.age) // 2
}
```

### ä¸¤ç§ç±»å‹æ¥æ”¶è€…çš„å·®å¼‚

ğŸ‘¨â€ğŸ’»å€¼æ¥æ”¶è€…æ–¹æ³•ï¼ˆValue receiver methodï¼‰å’ŒğŸ¥·æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ï¼ˆPointer receiver methodï¼‰ï¼Œéƒ½å¯ä»¥è¢«ç»“æ„ä½“å˜é‡ï¼ˆstruct variableï¼‰æˆ–ç»“æ„ä½“æŒ‡é’ˆï¼ˆstruct pointerï¼‰è°ƒç”¨ã€‚

ğŸ‘¨â€ğŸ’»å€¼æ¥æ”¶è€…æ–¹æ³•ä¸­ï¼Œå¯¹æ¥æ”¶è€…çš„ä¿®æ”¹ï¼Œâ **ä¸ä¼š** å½±å“è°ƒç”¨è€…ã€‚

ğŸ¥·æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ä¸­ï¼Œå¯¹æ¥æ”¶è€…çš„ä¿®æ”¹ï¼Œâœ… **ä¼š** å½±å“è°ƒç”¨è€…ã€‚

```go
type A struct {
    age int
}

func (a A) read() {
    a.age = 50
}

func (a *A) write(n int) {
    a.age = n
}

func main() {
    aV := A{age: 10}
    aP := &A{age: 10}
    
    aV.read()
    fmt.Println(aV.age)	// 10
    aV.write(15)
    fmt.Println(aV.age)	// 15
    
    aP.read()
    fmt.Println(aP.age)	// 10
    aP.write(18)
    fmt.Println(aP.age)	// 18
}
```

åœ¨ä¸Šè¿°æ —å­ä¸­ï¼Œ

-   aP æ˜¯ç»“æ„ä½“æŒ‡é’ˆï¼Œåœ¨ aP è°ƒç”¨å€¼æ–¹æ³• `aP.read()` æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è½¬æ¢ä¸º `(*aP).read()`ï¼›

-   aV æ˜¯ç»“æ„ä½“å˜é‡ï¼Œåœ¨ aV è°ƒç”¨æŒ‡é’ˆæ–¹æ³• `aV.write()` æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è½¬æ¢ä¸º `(&aV).write(15)`ã€‚

|                      | **å€¼æ¥æ”¶è€…æ–¹æ³•**                | **æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•**                       |
| -------------------- | ------------------------------- | ---------------------------------------- |
| **ç»“æ„ä½“å˜é‡è°ƒç”¨è€…** | å¯ä»¥è°ƒç”¨ï¼Œç±»ä¼¼äºä¼ å€¼            | å¯ä»¥è°ƒç”¨ï¼Œç›¸å½“äº `(&aV).write(15)`       |
| **ç»“æ„ä½“æŒ‡é’ˆè°ƒç”¨è€…** | å¯ä»¥è°ƒç”¨ï¼Œç›¸å½“äº `(*aP).read()` | å¯ä»¥è°ƒç”¨ï¼Œç±»ä¼¼ä¸ä¼ æŒ‡é’ˆï¼Œæ‰€ä»¥ä¼šå½±å“è°ƒç”¨è€… |
| **ä¿®æ”¹**             | ä¸å½±å“è°ƒç”¨è€…                    | å½±å“è°ƒç”¨è€…                               |

#### å¦‚ä½•é€‰æ‹©

è¦çœ‹ç±»å‹çš„æœ¬è´¨ã€‚å¦‚æœä¸€ä¸ªç»“æ„ä½“ç±»å‹çš„å®ä¾‹ï¼Œåº”è¯¥æ˜¯ç‹¬ä¸€ä»½çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ç”¨æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ã€‚

ä¾‹å¦‚ï¼Œæ–‡ä»¶ç»“æ„ä½“ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ç‹¬ä¸€ä»½çš„ï¼Œå¯¹åº”åœ°ï¼Œæ–‡ä»¶ç»“æ„ä½“è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åº”è¯¥å”¯ä¸€çš„ä»£è¡¨è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æ–‡ä»¶ç»“æ„ä½“çš„æ–¹æ³•åº”è¯¥ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•ã€‚

### ä»»æ„ç±»å‹æ·»åŠ æ–¹æ³•
åœ¨ Go ä¸­ï¼Œæ¥æ”¶è€…ç±»å‹å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ç»“æ„ä½“ï¼Œä»»ä½•ç±»å‹éƒ½å¯ä»¥æ‹¥æœ‰æ–¹æ³•ã€‚

```go
type Status int    // è‡ªå®šä¹‰ç±»å‹

func (s Status) say() {
    fmt.Println("OK")
}

func main() {
    var s Status
    s.say()
}
```

> **æ³¨æ„**ï¼š éæœ¬åœ°ç±»å‹ä¸èƒ½å®šä¹‰æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸èƒ½ç»™åˆ«çš„åŒ…çš„ç±»å‹å®šä¹‰æ–¹æ³•ã€‚



## å†…å­˜å¸ƒå±€

åœ¨ Go ä¸­ï¼Œç»“æ„ä½“å’Œå®ƒæ‰€åŒ…å«çš„æ•°æ®åœ¨å†…å­˜ä¸­æ˜¯ä»¥è¿ç»­å—çš„å½¢å¼å­˜åœ¨çš„ï¼Œå³ä½¿ç»“æ„ä½“ä¸­åµŒå¥—äº†ç»“æ„ä½“ä¹Ÿä¸€æ ·ã€‚

```go
type person struct {
    name string
    age  int8
}

type stu1 struct {
    ID     int8
    info   person
    depart string
}

type stu2 struct {
    ID     int8
    info   *person
    depart string
}
```
![](https://blogpicure.oss-cn-shenzhen.aliyuncs.com/blog/illustration-pic/Go/IMG/20201123131640736_15271.png)

## åŒ¿åå­—æ®µ
Go ä¸­çš„ç»“æ„ä½“å…è®¸å£°æ˜æ—¶åªæœ‰ç±»å‹è€Œæ²¡æœ‰åå­—ï¼Œè¿™æ ·çš„å­—æ®µå«åšåŒ¿åå­—æ®µ

```go
type stu struct {
    string
    int8
}

func main() {
    s1 := stu{
        "Boii",
        18,
    }
    fmt.Printf("%#v\n", s1)         // main.stu{string:"Boii", int8:18}
    fmt.Println(s1.string, s1.int8) // Boii 18
}
```
> åŒ¿åå­—æ®µé»˜è®¤é‡‡ç”¨ç±»å‹ä½œä¸ºå­—æ®µåï¼ŒåŒä¸€ä¸ªç»“æ„ä½“ä¸­ä¸€ç§ç±»å‹åªèƒ½æœ‰ä¸€ä¸ªåŒ¿åå­—æ®µã€‚

æ‰€ä»¥ä¸Šé¢çš„ç»“æ„ä½“ç­‰ä»·äºï¼š
```go
type stu struct {
    string string
    int8   int8
}
```

## åµŒå¥—ç»“æ„ä½“

åµŒå¥—ç»“æ„ä½“ï¼Œç®€å•è¯´å°±æ˜¯å¥—å¨ƒ
```go
type person struct {
    name string
    age  int8
}

// å¨ƒå¨ƒ2
type stu struct {
    ID     int8
    info   person  // å¥—å¨ƒå¨ƒ1
    depart string
}

func main() {
    stuA := stu{
        ID: 101,
        info: person{
            "Alice",
            18,
        },
        depart: "CA",
    }
    fmt.Printf("%#v\n", stuA) // main.stu{ID:1, info:main.person{name:"Boii", age:18}, depart:"CA"}
}
```

å¦‚æœç»“æ„ä½“å¤ªå¤§ï¼Œæ‹…å¿ƒå¼€é”€çš„è¯ï¼Œå¯ä»¥ç”¨ç»“æ„ä½“æŒ‡é’ˆ
```go
// å¨ƒå¨ƒ1
type person struct {
    name string
    age  int8
}

// å¨ƒå¨ƒ2
type stu2 struct {
    ID     int8
    info   *person // å¥—å¨ƒå¨ƒ1çš„æŒ‡é’ˆ
    depart string
}

func main() {
    stuB := stu2{
        ID: 102,
        info: &person{
            "Boii",
            20,
        },
        depart: "SE",
    }
    fmt.Printf("%#v\n", stuB) // main.stu2{ID:1, info:(*main.person)(0xc0000044a0), depart:"CA"}
}
```

ç”¨ç»“æ„ä½“å’Œç»“æ„ä½“æŒ‡é’ˆçš„å·®åˆ«å¦‚ä¸‹å›¾ï¼š
![](https://blogpicure.oss-cn-shenzhen.aliyuncs.com/blog/illustration-pic/Go/IMG/20201123131640736_15271.png)

æ˜¾ç„¶å½“ç»“æ„ä½“è¾ƒå¤§çš„æ—¶å€™ï¼Œä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆçš„æ“ä½œå¼€é”€ä¼šå¾ˆå°ã€‚

### åµŒå¥—ç»“æ„ä½“çš„åŒ¿åå­—æ®µ

```go
type addr struct {
    province string
    city     string
}

type user struct {
    name string
    age  int8
    addr // åŒ¿åå­—æ®µ
}

func main() {
    var userA user
    userA.name = "Boii"
    userA.age = 18
    userA.addr.province = "GD" // åŒ¿åå­—æ®µé»˜è®¤ä½¿ç”¨ç±»å‹åä½œä¸ºå­—æ®µå
    userA.city = "SWA"         // åŒ¿åå­—æ®µå¯ä»¥çœç•¥

    fmt.Printf("%#v \n", userA) // main.user{name:"Boii", age:18, addr:main.addr{province:"GD", city:"SWA"}}
}
```
### åµŒå¥—ç»“æ„ä½“å‘½åå†²çª
å½“åµŒå¥—ç»“æ„ä½“å‡ºç°å‘½åå†²çªçš„æ—¶å€™ï¼Œåªè¦ä¸çœç•¥ï¼ŒæŠŠå…³ç³»é“¾å†™æ¸…æ¥šå°±æ²¡äº‹äº†ã€‚

```go
type addr struct {
    province   string
    city       string
    createTime string    // å‘½åå†²çª
}

type user struct {
    name       string
    age        int8
    addr       // åŒ¿åå­—æ®µ
    createTime string    // å‘½åå†²çª
}

func main() {
    var userA user
    userA.name = "Boii"
    userA.age = 18
    userA.addr.province = "GD"
    userA.city = "SWA"
    // å‘½åå†²çªå­—æ®µ
    userA.createTime = "2020"        // å…³ç³»é“¾å†™æ¸…æ¥š
    userA.addr.createTime = "2021"   // å…³ç³»é“¾å†™æ¸…æ¥š

    fmt.Printf("%#v \n", userA)
    // main.user{name:"Boii", age:18, addr:main.addr{province:"GD", city:"SWA", createTime:"2021"}, createTime:"2020"}
}
```


## ç»“æ„ä½“çš„ç»§æ‰¿
åœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œç»§æ‰¿æŒ‡çš„æ˜¯å­ç±»å¯ä»¥æ‹¥æœ‰çˆ¶ç±»æ‰€æœ‰éç§æœ‰å±æ€§å’Œæ–¹æ³•ã€‚

Go ä¸­ä½¿ç”¨ç»“æ„ä½“åµŒå¥—ä¹Ÿå¯ä»¥å®ç°å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­é¢å‘å¯¹è±¡çš„ç»§æ‰¿ã€‚
æ–¹æ³•æ˜¯é€šè¿‡åœ¨ "å­ç»“æ„ä½“" ä¸­åµŒå¥— "çˆ¶ç»“æ„ä½“" ï¼Œè¿™æ · "å­ç»“æ„ä½“" å°±æ‹¥æœ‰ "çˆ¶ç»“æ„ä½“" çš„å±æ€§äº†

ç»“åˆä¸Šé¢ â€œåµŒå¥—ç»“æ„ä½“çš„åŒ¿åå­—æ®µâ€ ä¸­çš„ä¾‹å­ï¼Œæ— å‘½åå†²çªæ—¶ï¼Œå¯ä»¥é€šè¿‡ `å­ç»“æ„ä½“å®ä¾‹.çˆ¶ç»“æ„ä½“å±æ€§`è°ƒç”¨çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„ç¼–å†™å‡ºé€‚åˆ "å­ç»“æ„ä½“" çš„æ–¹æ³•ã€‚

```go
// animal åŠ¨ç‰©
type animal struct {
    name string
}

// dog ç‹—
type dog struct {
    variety string
    *animal // å­ç»“æ„ä½“åµŒå¥—çˆ¶ç»“æ„ä½“å®ç°ç»§æ‰¿ï¼Œå¿…é¡»ä½¿ç”¨åŒ¿åå­—æ®µ
}

func (d *dog) bark() {
    // dog æ²¡æœ‰ name å±æ€§ï¼Œä½†æ˜¯å†…åµŒçš„ animal æœ‰
    fmt.Printf("%s æ­£åœ¨æ±ªæ±ªæ±ª~", d.name)
}

func main() {
    doge := &dog{
        variety: "Doge",
        animal: &animal{ // æ³¨æ„åµŒå¥—çš„æ˜¯ç»“æ„ä½“æŒ‡é’ˆ
            name: "Boby",
        },
    }
    doge.bark() // Boby æ­£åœ¨æ±ªæ±ªæ±ª~
}
```



## ç»“æ„ä½“æ ‡ç­¾ Tag
`Tag` æ˜¯ç»“æ„ä½“çš„å…ƒä¿¡æ¯ï¼Œå¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™é€šè¿‡åå°„æœºåˆ¶è¯»å–ã€‚æ‰€ä»¥åªæœ‰é¦–å­—æ¯å¤§å†™çš„å¯è¢«å¯¼å‡ºçš„å˜é‡èƒ½è¢«åå°„è¯»å–ï¼Œè½¬æˆJSONã€‚
`Tag` åœ¨ç»“æ„ä½“å­—æ®µçš„åæ–¹å®šä¹‰ï¼Œç”±ä¸€å¯¹ **åå¼•å·** åŒ…èµ·æ¥ã€‚

egï¼š
```go
type person struct {
    Name string `json:"name"`
}
```

- ä¸€ä¸ª Tag ç”±ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹ç»„æˆã€‚
- **é”®å€¼å¯¹** ä¹‹é—´ä½¿ç”¨ç©ºæ ¼åˆ†éš”
- **é”®** ä¸ **å€¼** ä¹‹é—´ä½¿ç”¨å†’å·åˆ†éš”ï¼Œä¸èƒ½æœ‰ç©ºæ ¼
- å€¼ä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚
- å€¼ä¸º `-` æ—¶è¯¥å­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–

ç¼–å†™ `Tag` æ—¶å¿…é¡»ä¸¥æ ¼éµå®ˆé”®å€¼å¯¹çš„è§„åˆ™ã€‚ç»“æ„ä½“æ ‡ç­¾çš„è§£æå®¹é”™èƒ½åŠ›å¾ˆå·®ï¼Œå†™é”™äº†ç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸéƒ½ä¸ä¼šæç¤ºä»»ä½•é”™è¯¯ï¼Œåå°„ä¹Ÿæ— æ³•æ­£ç¡®å–å€¼ã€‚



## ç»“æ„ä½“åºåˆ—åŒ–

**åºåˆ—åŒ–ï¼ˆstruct -> JSONï¼‰**ï¼šç»“æ„ä½“å¯¹è±¡ è½¬æˆ JSONæ ¼å¼å­—ç¬¦ä¸²

**ååºåˆ—åŒ–ï¼ˆJSON -> structï¼‰**ï¼šJSONæ ¼å¼å­—ç¬¦ä¸² è½¬æˆ ç»“æ„ä½“å¯¹è±¡

ä½¿ç”¨ `encoding/json` å®Œæˆã€‚
```go
import "encoding/json"
```

```go
// åºåˆ—åŒ–å‡½æ•°ï¼Œstruct -> JSON
func Marshal(v interface{}) ([]byte, error) {}

// ååºåˆ—åŒ–å‡½æ•°ï¼ŒJSON -> struct
func Unmarshal(data []byte, v interface{}) error {}
```

!!! example
    ```go
    package main

    import (
        "encoding/json"
        "fmt"
    )

    // 1. åºåˆ—åŒ– encodeï¼šæŠŠç»“æ„ä½“å˜é‡ -> jsonæ ¼å¼çš„å­—ç¬¦ä¸²
    // 2. ååºåˆ—åŒ– decodeï¼šjsonæ ¼å¼çš„å­—ç¬¦ä¸² -> ç»“æ„ä½“å˜é‡

    type person struct {
        Name string `json:"name" db:"name" ini:"name"`
        Age  int    `json:"age"`
        Sex  string
        Addr string `json:"-"`    // value ä¸º "-" æ—¶ä¸åºåˆ—åŒ–
    }

    func main() {
        p1 := person{"Boii", 18, "male"}

        /* åºåˆ—åŒ– */
        b, err := json.Marshal(p1)
        if err != nil {
            fmt.Println(err)
        }
        fmt.Println(string(b))          // {"name":"Boii","age":18,"Sex":"male"}
        fmt.Printf("%T \n", b)          // []uint8

        /* ååºåˆ—åŒ– */
        str := `{"name":"Eva","age":18}`
        var p2 person
        json.Unmarshal([]byte(str), &p2)
        fmt.Printf("%#v \n", p2)        // main.person{Name:"Eva", Age:18, Sex:""}
        fmt.Printf("%T \n", p2)         // main.person
    }
    ```
åºåˆ—åŒ–æ—¶ï¼Œkey ä¼šä¼˜å…ˆé€‰æ‹©å­—æ®µçš„ Tag ä¸­æŒ‡å®šçš„ key

!!! warning
    **ç»“æ„ä½“ä¸­é public çš„å­—æ®µï¼ˆé¦–å­—æ¯å°å†™çš„å­—æ®µï¼‰ä¸ä¼šè¢«åºåˆ—åŒ–**

## ç»“æ„ä½“çš„æ·±æµ…æ‹·è´

!!! note
    æ·±æ‹·è´ï¼šå³ **ä¸ºæ–°çš„å¯¹è±¡åˆ†é…äº†å†…å­˜**ï¼Œå¯¹æ–°å¯¹è±¡çš„ä¿®æ”¹ â **ä¸ä¼š** å½±å“æ—§å¯¹è±¡

    æµ…æ‹·è´ï¼šå³ **å¤åˆ¶äº†æ—§å¯¹è±¡çš„åœ°å€**ï¼Œå¯¹æ–°å¯¹è±¡çš„ä¿®æ”¹ âœ… **ä¼š** å½±å“æ—§å¯¹è±¡

    å€¼ç±»å‹éƒ½æ˜¯æ·±æ‹·è´

    å¼•ç”¨ç±»å‹éƒ½æ˜¯æµ…æ‹·è´

çœ‹æ‡‚ä»¥ä¸Šä¸¤å¥è¯ï¼Œç»“æ„ä½“çš„æ·±æµ…æ‹·è´å°±å¾ˆå®¹æ˜“å®ç°äº†

```go
package main

import "fmt"

type Person struct {
    name string
    age  int
}

func main() {
    // ç»“æ„ä½“çš„æ·±æ‹·è´
    person1 := Person{"Boii", 18}
    person2 := person1   // æ·±æ‹·è´
    fmt.Println(person1) // {Boii 18}
    fmt.Println(person2) // {Boii 18}

    person2.age = 20

    fmt.Println(person1) // {Boii 18}
    fmt.Println(person2) // {Boii 20}

    // ç»“æ„ä½“çš„æµ…æ‹·è´
    person3 := &person1 // æµ…æ‹·è´
    person3.age = 20
    fmt.Println(person1) // {Boii 20}
    fmt.Println(person3) // &{Boii 20}
}
```
ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œç›´æ¥èµ‹å€¼çš„æ—¶å€™æ˜¯æ·±æ‹·è´ï¼Œèµ‹å€¼ä¸€ä¸ªæŒ‡é’ˆåˆ™æ˜¯æµ…æ‹·è´
