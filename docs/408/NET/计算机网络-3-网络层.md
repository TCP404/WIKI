# 网络层

![image-20250128101858883](/Users/boii/N/408/计算机网络/IMG/image-20250128101858883.png)

.0 是网络地址，.255 是广播地址。例如： 220.34.56.1 的网络地址就是 220.34.56.0，广播地址就是 220.34.56.255



IP 分类

- A 类：1 ~ 126
- 本地环回地址：127
- B 类：128 ~ 191
- C 类：192 ~ 223
- D 类：224 ~ 239
- E 类：240 ~ 255



特殊 IP 地址，不能指派给网络中任何一台主机或路由器“私用”

| Net ID 网络号 | Host ID 主机号    | 十进制          | 作为 IP 分组源地址 | 作为 IP 分组目的地址 | 用途                                   |
| ------------- | ----------------- | --------------- | ------------------ | -------------------- | -------------------------------------- |
| 0000 0000     | 0000 0000         | 0.0.0.0         | ✔可以              | ❌不可以              | 本网中表示主机，路由器中表示默认路由   |
| 0000 0000     | 特定值            | 0.x             | ✔可以              | ❌不可以              | 本网内某个特定主机                     |
| 1111 1111     | 1111 1111         | 255.255.255.255 | ❌不可以            | ✔可以                | 本网广播地址，路由器不转发             |
| 特定值        | 0000 0000         | x.0             | ❌不可以            | ❌不可以              | 网络地址，例如220.34.56.0              |
| 特定值        | 1111 1111         | x.1             | ❌不可以            | ✔可以                | 直接广播地址，对特定网络上所有主机广播 |
| 127           | 任何数（非全0/1） | 127.x           | ✔可以              | ✔可以                | 本地环回地址，用于测试                 |

 

私有 IP 地址

| 地址类别 | 地址范围                      | 二进制                | CIDR           | 网段个数 |
| -------- | ----------------------------- | --------------------- | -------------- | -------- |
| A 类     | 10.0.0.0 ~ 10.255.255.255     | 0000 1010.x.x.x       | 10.0.0.0/8     | 1        |
| B 类     | 172.16.0.0 ~ 172.31.255.255   | 1010 1100.0001 0000.x | 172.16.0.0/12  | 16       |
| C 类     | 192.168.0.0 ~ 192.168.255.255 | 1100 0000.1010 1000.x | 192.168.0.0/16 | 256      |



主机发送 IP 数据包的过程：

1. 通过（目的 IP & 子网掩码） == （本机 IP & 子网掩码），判断目的 IP 与本机 IP 是否为同一子网：
    - 是说明处于同一子网
    - 否说明不处于同一子网
2. 本机将 IP 数据报封装成 MAC 帧并发送到数据链路上：
    - 如果属于同一子网，就通过 ARP 协议找到目的主机的 MAC 地址，再封装成数据帧发送给目的主机
    - 如果不属于同一子网，就通过 ARP 协议找到默认网关的 MAC 地址，再封装成数据帧发送给默认网关



路由器转发 IP 数据包过程：

1. 路由器的某个接口接收到一个 IP 数据包，先从数据包中找到首部校验和进行首部校验，并找到目的 IP 地址
2. 查转发表，转发表项包含 <目的网络号，子网掩码，转发接口号>，至少有一条默认路由 <0.0.0.0，255.0.0.0，x>
    1. 通过（目的 IP 地址 & 子网掩码）== 目的网路号得到转发接口号
    2. 将数据报从匹配的转发接口转发出去（如果转发接口与该 IP 数据报的入口相同不转发回去）